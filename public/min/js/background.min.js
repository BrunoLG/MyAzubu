function checkOnline(){localStorage.setItem("azubu_extension_running",!0);var a=JSON.parse(localStorage.getItem("azubu_extension")),b=new Following(a.usernames),c=new Online(a.online);for(var d in b.getAll()){var e=b.getAll()[d];$.ajax({method:"GET",url:"http://api.azubu.tv/public/channel/"+e+"/info",type:"json",async:!1,success:function(a){if(a.data.is_live){if(!c.has(e)){var b=new Notification(e,{tag:"started streamming on Azubu.tv",icon:a.data.url_thumbnail});b.onclick=function(){window.open("http://azubu.tv/"+e)},setTimeout(function(){b.close()},3e3),c.add(e)}}else c.has(e)&&c.remove(e)}})}chrome.browserAction.setBadgeText({text:""+c.getAll().length}),localStorage.removeItem("azubu_extension_running")}chrome.browserAction.setBadgeText({text:"0"}),localStorage.getItem("azubu_extension")||localStorage.setItem("azubu_extension",'{"usernames": [], "online": []}'),setInterval(function(){var a=JSON.parse(localStorage.getItem("azubu_extension")),b=new Following(a.usernames),c=new Online(a.online);for(var d in c.getAll())b.has(c.getAll()[d])||c.remove(c.getAll()[d]);chrome.browserAction.setBadgeText({text:""+c.getAll().length})},500);var extData=JSON.parse(localStorage.getItem("azubu_extension"));extData.online=[],localStorage.setItem("azubu_extension",JSON.stringify(extData)),localStorage.setItem("azubu_extension_running",!0),checkOnline(),localStorage.removeItem("azubu_extension_running"),setInterval(function(){checkOnline()},3e4);